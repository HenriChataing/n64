start_address = "0xffffffff802e1124"

asm_code = """
    lhu      t8, 0x12(sp)
    sw       a3, 0xc(sp)
    lui      at, 0x800
    andi     t1, a2, 0xffff
    or       t9, t8, at
    sw       t9, 0x0(a0)
    sw       t1, 0x4(a0)
    lw       t2, 0x14(sp)
    lui      at, 0x500
    andi     t6, a3, 0xffff
    andi     t3, t2, 0xff
    sll      t4, t3, 16
    or       t5, t4, at
    addiu    t0, a0, 0x8
    or       t7, t5, t6
    sw       t7, 0x0(t0)
    lw       t8, 0xc(a1)
    lui      at, 0x8000
    ori      at, at, 0x20
    addu     t9, t8, at
    sw       t9, 0x4(t0)
    jr       ra
    addiu    v0, t0, 0x8
"""

bin_code = [
    0x97b80012, 0xafa7000c, 0x3c010800, 0x30c9ffff,
    0x0301c825, 0xac990000, 0xac890004, 0x8faa0014,
    0x3c010500, 0x30eeffff, 0x314b00ff, 0x000b6400,
    0x01816825, 0x24880008, 0x01ae7825, 0xad0f0000,
    0x8cb8000c, 0x3c018000, 0x34210020, 0x0301c821,
    0xad190004, 0x03e00008, 0x25020008,
]

[[test]]
end_address = "0xffffffff802e0fa0"
trace = [
    { type = "load_u16", address = "0x001fff1a", value = "0x186" },
    { type = "store_u32", address = "0x001fff14", value = "0x404b" },
    { type = "store_u32", address = "0x001d33c8", value = "0x8000186" },
    { type = "store_u32", address = "0x001d33cc", value = "0xf0" },
    { type = "load_u32", address = "0x001fff1c", value = "0x0" },
    { type = "store_u32", address = "0x001d33d0", value = "0x500404b" },
    { type = "load_u32", address = "0x001d169c", value = "0x801d26e0" },
    { type = "store_u32", address = "0x001d33d4", value = "0x1d2700" },
]

[[test]]
end_address = "0xffffffff802e0fa0"
trace = [
    { type = "load_u16", address = "0x001fff1a", value = "0x18a" },
    { type = "store_u32", address = "0x001fff14", value = "0x3fd1" },
    { type = "store_u32", address = "0x001d33c8", value = "0x800018a" },
    { type = "store_u32", address = "0x001d33cc", value = "0xf0" },
    { type = "load_u32", address = "0x001fff1c", value = "0x0" },
    { type = "store_u32", address = "0x001d33d0", value = "0x5003fd1" },
    { type = "load_u32", address = "0x001d169c", value = "0x801d26e0" },
    { type = "store_u32", address = "0x001d33d4", value = "0x1d2700" },
]

