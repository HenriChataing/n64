start_address = "0xffffffff802e0784"

asm_code = """
    lhu      t8, 0xa(s1)
    or       a2, s7, zero
    sh       t8, 0x11a(sp)
    lhu      t9, 0x0(s1)
    andi     t8, t8, 0xffff
    andi     t6, t9, 0x1
    lw       t9, 0x158(sp)
    addiu    t7, t6, 0x1
    sw       t7, 0xbc(sp)
    multu    t8, t9
    lhu      t8, 0x4(s7)
    mflo     t6
    sll      t7, t6, 1
    addu     v0, t7, t8
    sh       v0, 0x4(s7)
    lw       a3, 0x0(s1)
    lw       a0, 0x15c(sp)
    srl      s0, v0, 16
    sll      t7, a3, 14
    bgezl    t7, 0xffffffff802e0808
    lw       t7, 0xc(s1)
"""

bin_code = [
    0x9638000a, 0x02e03025, 0xa7b8011a, 0x96390000,
    0x3318ffff, 0x332e0001, 0x8fb90158, 0x25cf0001,
    0xafaf00bc, 0x03190019, 0x96f80004, 0x00007012,
    0x000e7840, 0x01f81021, 0xa6e20004, 0x8e270000,
    0x8fa4015c, 0x00028402, 0x00077b80, 0x05e3000d,
    0x8e2f000c,
]

[[test]]
end_address = "0xffffffff802e0808"
trace = [
    { type = "load_u16", address = "0x001d2dea", value = "0x4006" },
    { type = "store_u16", address = "0x00200022", value = "0x4006" },
    { type = "load_u16", address = "0x001d2de0", value = "0x8200" },
    { type = "load_u32", address = "0x00200060", value = "0x78" },
    { type = "store_u32", address = "0x001fffc4", value = "0x1" },
    { type = "load_u16", address = "0x001d1694", value = "0xdca0" },
    { type = "store_u16", address = "0x001d1694", value = "0xe240" },
    { type = "load_u32", address = "0x001d2de0", value = "0x82000a00" },
    { type = "load_u32", address = "0x00200064", value = "0x801d74c0" },
    { type = "load_u32", address = "0x001d2dec", value = "0x801ee0a0" },
]

[[test]]
end_address = "0xffffffff802e0808"
trace = [
    { type = "load_u16", address = "0x001d2dea", value = "0x3fee" },
    { type = "store_u16", address = "0x00200022", value = "0x3fee" },
    { type = "load_u16", address = "0x001d2de0", value = "0x8200" },
    { type = "load_u32", address = "0x00200060", value = "0x78" },
    { type = "store_u32", address = "0x001fffc4", value = "0x1" },
    { type = "load_u16", address = "0x001d1694", value = "0x4390" },
    { type = "store_u16", address = "0x001d1694", value = "0x32b0" },
    { type = "load_u32", address = "0x001d2de0", value = "0x82000a00" },
    { type = "load_u32", address = "0x00200064", value = "0x801d74c0" },
    { type = "load_u32", address = "0x001d2dec", value = "0x801ee0a0" },
]

